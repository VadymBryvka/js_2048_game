!function(){"use strict";var t={},e=new(function(){var t;function e(t){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addRandomTile=this.addRandomTile.bind(this),this.start=this.start.bind(this),this.status="idle",this.score=0}return t=[{key:"start",value:function(){this.status="playing",this.addRandomTile()}},{key:"restart",value:function(){this.status="playing",this.score=0,this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addRandomTile()}},{key:"cellMerge",value:function(){for(var t=!1,e=0;e<this.board.length;e++){for(var r=this.board[e].filter(function(t){return 0!==t}),a=0;a<r.length-1;a++)r[a]===r[a+1]&&(r[a]*=2,r[a+1]=0,t=!0);for(r=r.filter(function(t){return 0!==t});r.length<this.board[e].length;)r.push(0);this.board[e].join("")!==r.join("")&&(this.board[e]=r,t=!0)}return t}},{key:"moveLeft",value:function(){this.cellMerge()&&this.addRandomTile(),this.cellMerge()}},{key:"moveRight",value:function(){this.rotateGrid(this.board,!0),this.rotateGrid(this.board,!0);var t=this.cellMerge();return this.rotateGrid(this.board,!1),this.rotateGrid(this.board,!1),t&&this.addRandomTile(),t}},{key:"moveUp",value:function(){this.rotateGrid(this.board,!1);var t=this.cellMerge();return this.rotateGrid(this.board,!0),t&&this.addRandomTile(),t}},{key:"moveDown",value:function(){this.rotateGrid(this.board,!0);var t=this.cellMerge();return this.rotateGrid(this.board,!1),t&&this.addRandomTile(),t}},{key:"rotateGrid",value:function(t){for(var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=t.length,a=Array(r).fill(null).map(function(){return Array(r).fill(0)}),s=0;s<r;s++)for(var o=0;o<r;o++)e?a[o][r-1-s]=t[s][o]:a[r-1-o][s]=t[s][o];this.board=a}},{key:"addRandomTile",value:function(){for(var t=[],e=0;e<this.board.length;e++)for(var r=0;r<this.board[e].length;r++)0===this.board[e][r]&&t.push({row:e,col:r});if(t.length>0){var a=Math.floor(Math.random()*t.length),s=t[a],o=s.row,i=s.col;this.board[o][i]=.9>Math.random()?2:4}return this.board}},{key:"getState",value:function(){var t=document.querySelector("tbody");t.innerHTML="",this.board.forEach(function(e){var r=document.createElement("tr");r.classList.add("field-row"),e.forEach(function(t){var e=document.createElement("td");e.textContent=0!==t?t:"",e.classList.add("field-cell"),e.setAttribute("class","field-cell field-cell--".concat(t)),r.appendChild(e)}),t.appendChild(r)})}},{key:"getScore",value:function(){for(var t=0;t<this.board.length;t++)for(var e=0;e<this.board[t].length;e++)this.board[t][e]>this.score&&(this.score=this.board[t][e]);return this.score}},{key:"canMove",value:function(){for(var t=JSON.parse(JSON.stringify(this.board)),e=0;e<t.length;e++)for(var r=0;r<t[e].length-1;r++)if(0===t[e][r+1]||0===t[e][r]||t[e][r]===t[e][r+1])return!0;for(var a=0;a<t[0].length;a++)for(var s=0;s<t.length-1;s++)if(0===t[s+1][a]||0===t[s][a]||t[s][a]===t[s+1][a])return!0;return!1}},{key:"getStatus",value:function(){for(var t=0;t<this.board.length;t++)for(var e=0;e<this.board[t].length;e++)2048===this.board[t][e]&&(this.status="win");return"playing"!==this.status||this.canMove()||(this.status="lose"),this.status}}],function(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(e.prototype,t),e}()),r=document.querySelector(".button"),a=document.querySelector(".game-score"),s=document.querySelector(".message-start"),o=document.querySelector(".message-lose");r.addEventListener("click",function(){"button start"===r.getAttribute("class")?(r.setAttribute("class","button restart"),r.textContent="Restart",s.style="display: none",e.start()):(o.setAttribute("class","message message-lose hidden"),e.restart()),e.getState(),e.getStatus(),a.textContent=e.getScore()}),document.addEventListener("keydown",function(t){if("playing"===e.getStatus()){switch(t.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}e.getState(),"win"===e.getStatus()?document.querySelector(".message-win").setAttribute("class","message message-win"):"lose"===e.getStatus()&&document.querySelector(".message-lose").setAttribute("class","message message-lose"),a.textContent=e.getScore()}})}();
//# sourceMappingURL=js_2048_game.78112b6f.js.map
