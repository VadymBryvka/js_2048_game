var t={};const e=new class{constructor(t){this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addRandomTile=this.addRandomTile.bind(this),this.start=this.start.bind(this),this.status="idle",this.score=0}start(){this.status="playing",this.addRandomTile()}restart(){this.status="playing",this.score=0,this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addRandomTile()}cellMerge(){let t=!1;for(let e=0;e<this.board.length;e++){let s=this.board[e].filter(t=>0!==t);for(let e=0;e<s.length-1;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,t=!0);for(s=s.filter(t=>0!==t);s.length<this.board[e].length;)s.push(0);this.board[e].join("")!==s.join("")&&(this.board[e]=s,t=!0)}return t}moveLeft(){this.cellMerge()&&this.addRandomTile(),this.cellMerge()}moveRight(){this.rotateGrid(this.board,!0),this.rotateGrid(this.board,!0);let t=this.cellMerge();return this.rotateGrid(this.board,!1),this.rotateGrid(this.board,!1),t&&this.addRandomTile(),t}moveUp(){this.rotateGrid(this.board,!1);let t=this.cellMerge();return this.rotateGrid(this.board,!0),t&&this.addRandomTile(),t}moveDown(){this.rotateGrid(this.board,!0);let t=this.cellMerge();return this.rotateGrid(this.board,!1),t&&this.addRandomTile(),t}rotateGrid(t,e=!0){let s=t.length,r=Array(s).fill(null).map(()=>Array(s).fill(0));for(let o=0;o<s;o++)for(let a=0;a<s;a++)e?r[a][s-1-o]=t[o][a]:r[s-1-a][o]=t[o][a];this.board=r}addRandomTile(){let t=[];for(let e=0;e<this.board.length;e++)for(let s=0;s<this.board[e].length;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let e=Math.floor(Math.random()*t.length),{row:s,col:r}=t[e];this.board[s][r]=.9>Math.random()?2:4}return this.board}getState(){let t=document.querySelector("tbody");t.innerHTML="",this.board.forEach(e=>{let s=document.createElement("tr");s.classList.add("field-row"),e.forEach(t=>{let e=document.createElement("td");e.textContent=0!==t?t:"",e.classList.add("field-cell"),e.setAttribute("class",`field-cell field-cell--${t}`),s.appendChild(e)}),t.appendChild(s)})}getScore(){for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)this.board[t][e]>this.score&&(this.score=this.board[t][e]);return this.score}canMove(){let t=JSON.parse(JSON.stringify(this.board));for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length-1;s++)if(0===t[e][s+1]||0===t[e][s]||t[e][s]===t[e][s+1])return!0;for(let e=0;e<t[0].length;e++)for(let s=0;s<t.length-1;s++)if(0===t[s+1][e]||0===t[s][e]||t[s][e]===t[s+1][e])return!0;return!1}getStatus(){for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)2048===this.board[t][e]&&(this.status="win");return"playing"!==this.status||this.canMove()||(this.status="lose"),this.status}},s=document.querySelector(".button"),r=document.querySelector(".game-score"),o=document.querySelector(".message-start"),a=document.querySelector(".message-lose");s.addEventListener("click",()=>{"button start"===s.getAttribute("class")?(s.setAttribute("class","button restart"),s.textContent="Restart",o.style="display: none",e.start()):(a.setAttribute("class","message message-lose hidden"),e.restart()),e.getState(),e.getStatus(),r.textContent=e.getScore()}),document.addEventListener("keydown",t=>{if("playing"===e.getStatus()){switch(t.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}e.getState(),"win"===e.getStatus()?document.querySelector(".message-win").setAttribute("class","message message-win"):"lose"===e.getStatus()&&document.querySelector(".message-lose").setAttribute("class","message message-lose"),r.textContent=e.getScore()}});
//# sourceMappingURL=js_2048_game.9bb954e2.js.map
